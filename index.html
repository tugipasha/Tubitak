<!doctype html>
<html lang="tr" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AkÄ±llÄ± Ev Kiralama Sistemi</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .room-icon {
            width: 80px;
            height: 80px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .room-icon {
                width: 65px;
                height: 65px;
                font-size: 12px;
            }
        }
        
        .room-available {
            background: #10b981;
            color: white;
        }
        
        .room-available:hover {
            background: #059669;
            transform: scale(1.05);
        }
        
        .room-occupied {
            background: #ef4444;
            color: white;
            cursor: not-allowed;
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 999;
        }
        
        .qr-code {
            width: 200px;
            height: 200px;
            background: white;
            border: 2px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app" class="h-full w-full"></div>
  <script>
        const defaultConfig = {
            app_title: "AkÄ±llÄ± Ev Kiralama Sistemi",
            welcome_message: "AkÄ±llÄ± ev kiralama sistemine hoÅŸ geldiniz",
            support_phone: "0850 XXX XX XX",
            support_email: "destek@akilliev.com",
            background_color: "#f3f4f6",
            surface_color: "#ffffff",
            text_color: "#1f2937",
            primary_action_color: "#3b82f6",
            secondary_action_color: "#6b7280",
            font_family: "system-ui",
            font_size: 16
        };

        let currentUser = null;
        let currentView = 'login';
        let rooms = [];

        // Initialize 10 rooms
        for (let i = 1; i <= 10; i++) {
            rooms.push({
                id: i,
                number: i,
                status: 'available',
                currentReservation: null
            });
        }

        // LocalStorage helper functions
        function getUsers() {
            const users = localStorage.getItem('users');
            return users ? JSON.parse(users) : [];
        }

        function saveUser(user) {
            const users = getUsers();
            users.push(user);
            localStorage.setItem('users', JSON.stringify(users));
        }

        function updateUser(updatedUser) {
            const users = getUsers();
            const index = users.findIndex(u => u.id === updatedUser.id);
            if (index !== -1) {
                users[index] = updatedUser;
                localStorage.setItem('users', JSON.stringify(users));
            }
        }

        function getReservations() {
            const reservations = localStorage.getItem('reservations');
            return reservations ? JSON.parse(reservations) : [];
        }

        function saveReservation(reservation) {
            const reservations = getReservations();
            reservations.push(reservation);
            localStorage.setItem('reservations', JSON.stringify(reservations));
            updateRoomStatus();
        }

        function updateReservation(updatedReservation) {
            const reservations = getReservations();
            const index = reservations.findIndex(r => r.id === updatedReservation.id);
            if (index !== -1) {
                reservations[index] = updatedReservation;
                localStorage.setItem('reservations', JSON.stringify(reservations));
                updateRoomStatus();
            }
        }

        function updateRoomStatus() {
            const now = new Date();
            const reservations = getReservations();
            
            rooms.forEach(room => {
                const activeReservation = reservations.find(r => 
                    r.room_number === room.number && 
                    r.status === 'active' &&
                    new Date(r.check_in) <= now &&
                    new Date(r.check_out) > now
                );
                
                if (activeReservation) {
                    room.status = 'occupied';
                    room.currentReservation = activeReservation;
                } else {
                    room.status = 'available';
                    room.currentReservation = null;
                }
            });
        }

        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.style.background = type === 'error' ? '#fee2e2' : type === 'success' ? '#d1fae5' : '#dbeafe';
            toast.style.color = type === 'error' ? '#991b1b' : type === 'success' ? '#065f46' : '#1e40af';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        function validatePassword(password) {
            const hasLetter = /[a-zA-Z]/.test(password);
            const hasPunctuation = /[!@#$%^&*(),.?":{}|<>]/.test(password);
            return hasLetter && hasPunctuation;
        }

        function validateTCKimlik(tc) {
            return tc.length === 11 && /^\d+$/.test(tc);
        }

        function handleLogin(e) {
            e.preventDefault();
            const tcKimlik = document.getElementById('login-tc').value;
            const password = document.getElementById('login-password').value;
            
            if (!validateTCKimlik(tcKimlik)) {
                showToast('GeÃ§erli bir T.C. Kimlik No giriniz', 'error');
                return;
            }
            
            const users = getUsers();
            const user = users.find(u => u.tc_kimlik === tcKimlik && u.password === password);
            
            if (user) {
                currentUser = user;
                currentView = 'dashboard';
                renderCurrentView();
                showToast('GiriÅŸ baÅŸarÄ±lÄ±!', 'success');
            } else {
                showToast('T.C. Kimlik No veya ÅŸifre hatalÄ±', 'error');
            }
        }

        function handleRegister(e) {
            e.preventDefault();
            
            const ad = document.getElementById('reg-ad').value;
            const soyad = document.getElementById('reg-soyad').value;
            const telefon = document.getElementById('reg-telefon').value;
            const email = document.getElementById('reg-email').value;
            const tcKimlik = document.getElementById('reg-tc').value;
            const cinsiyet = document.getElementById('reg-cinsiyet').value;
            const username = document.getElementById('reg-username').value;
            const password = document.getElementById('reg-password').value;
            const passwordConfirm = document.getElementById('reg-password-confirm').value;
            const kvkkAccept = document.getElementById('reg-kvkk').checked;
            const termsAccept = document.getElementById('reg-terms').checked;
            
            if (!validateTCKimlik(tcKimlik)) {
                showToast('GeÃ§erli bir T.C. Kimlik No giriniz', 'error');
                return;
            }
            
            if (!validatePassword(password)) {
                showToast('Åžifre en az 1 harf ve 1 noktalama iÅŸareti iÃ§ermelidir', 'error');
                return;
            }
            
            if (password !== passwordConfirm) {
                showToast('Åžifreler eÅŸleÅŸmiyor', 'error');
                return;
            }
            
            if (!kvkkAccept || !termsAccept) {
                showToast('KullanÄ±m ÅŸartlarÄ± ve KVKK onayÄ± zorunludur', 'error');
                return;
            }
            
            const users = getUsers();
            const existingUser = users.find(u => u.username === username);
            
            if (existingUser) {
                showToast('Bu kullanÄ±cÄ± adÄ± zaten alÄ±nmÄ±ÅŸ', 'error');
                return;
            }
            
            const newUser = {
                id: Date.now().toString(),
                tc_kimlik: tcKimlik,
                username,
                password,
                ad,
                soyad,
                telefon,
                email,
                cinsiyet,
                created_at: new Date().toISOString()
            };
            
            saveUser(newUser);
            showToast('Ãœyelik baÅŸarÄ±yla oluÅŸturuldu!', 'success');
            currentView = 'login';
            renderCurrentView();
        }

        function continueWithoutLogin() {
            currentUser = null;
            currentView = 'rooms';
            renderCurrentView();
        }

        function logout() {
            currentUser = null;
            currentView = 'login';
            renderCurrentView();
        }

        function getUserReservations() {
            if (!currentUser) return { active: null, past: [], cancelled: [] };
            
            const now = new Date();
            const reservations = getReservations();
            const userReservations = reservations.filter(r => r.user_id === currentUser.id);
            
            const active = userReservations.find(r => 
                r.status === 'active' && new Date(r.check_out) > now
            );
            
            const past = userReservations.filter(r => 
                r.status === 'active' && new Date(r.check_out) <= now
            );
            
            const cancelled = userReservations.filter(r => r.status === 'cancelled');
            
            return { active, past, cancelled };
        }

        function cancelReservation(reservationId, reason) {
            const reservations = getReservations();
            const reservation = reservations.find(r => r.id === reservationId);
            if (!reservation) return;
            
            reservation.status = 'cancelled';
            reservation.cancellation_reason = reason;
            reservation.cancelled_at = new Date().toISOString();
            
            updateReservation(reservation);
            showToast('Rezervasyon iptal edildi', 'success');
            currentView = 'dashboard';
            renderCurrentView();
        }

        function makeReservation(roomNumber) {
            if (!currentUser) {
                showToast('Rezervasyon yapmak iÃ§in lÃ¼tfen giriÅŸ yapÄ±nÄ±z', 'error');
                return;
            }
            
            currentView = 'reservation';
            window.selectedRoom = roomNumber;
            renderCurrentView();
        }

        function submitReservation(e) {
            e.preventDefault();
            
            const guestCount = document.getElementById('guest-count').value;
            const checkIn = document.getElementById('check-in').value;
            const checkOut = document.getElementById('check-out').value;
            
            const checkInDate = new Date(checkIn);
            const checkOutDate = new Date(checkOut);
            
            if (checkOutDate <= checkInDate) {
                showToast('Ã‡Ä±kÄ±ÅŸ saati giriÅŸ saatinden sonra olmalÄ±dÄ±r', 'error');
                return;
            }
            
            const reservations = getReservations();
            const lastReservation = reservations
                .filter(r => r.room_number === window.selectedRoom && r.status === 'active')
                .sort((a, b) => new Date(b.check_out) - new Date(a.check_out))[0];
            
            if (lastReservation) {
                const lastCheckOut = new Date(lastReservation.check_out);
                const thirtyMinutesAfter = new Date(lastCheckOut.getTime() + 30 * 60000);
                
                if (checkInDate < thirtyMinutesAfter) {
                    showToast('Bu oda iÃ§in en erken giriÅŸ saati: ' + thirtyMinutesAfter.toLocaleString('tr-TR'), 'error');
                    return;
                }
            }
            
            const hours = (checkOutDate - checkInDate) / (1000 * 60 * 60);
            const price = hours * 100;
            
            window.pendingReservation = {
                room_number: window.selectedRoom,
                guest_count: guestCount,
                check_in: checkIn,
                check_out: checkOut,
                hours: hours.toFixed(1),
                price: price
            };
            
            currentView = 'payment';
            renderCurrentView();
        }

        function processPayment(e) {
            e.preventDefault();
            
            const cardNumber = document.getElementById('card-number').value;
            const cvv = document.getElementById('cvv').value;
            const expiry = document.getElementById('expiry').value;
            
            if (!cardNumber || !cvv || !expiry) {
                showToast('TÃ¼m kart bilgilerini giriniz', 'error');
                return;
            }
            
            const reservation = {
                id: Date.now().toString(),
                user_id: currentUser.id,
                room_number: window.pendingReservation.room_number,
                guest_count: window.pendingReservation.guest_count,
                check_in: window.pendingReservation.check_in,
                check_out: window.pendingReservation.check_out,
                price: window.pendingReservation.price,
                status: 'active',
                ticket_number: 'TKT' + Date.now(),
                created_at: new Date().toISOString()
            };
            
            saveReservation(reservation);
            window.currentTicket = reservation;
            currentView = 'ticket';
            renderCurrentView();
            showToast('Ã–deme baÅŸarÄ±lÄ±!', 'success');
        }

        function renderLogin() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const appTitle = window.elementSdk?.config?.app_title || defaultConfig.app_title;
            const welcomeMsg = window.elementSdk?.config?.welcome_message || defaultConfig.welcome_message;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; display: flex; align-items: center; justify-content: center; padding: 16px;">
                    <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 400px; width: 100%;">
                        <h1 style="font-size: ${baseSize * 1.8}px; font-weight: 700; margin-bottom: 8px; text-align: center;">${appTitle}</h1>
                        <p style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7; text-align: center; margin-bottom: 24px;">${welcomeMsg}</p>
                        
                        <form onsubmit="handleLogin(event)">
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">T.C. Kimlik No</label>
                                <input type="text" id="login-tc" maxlength="11" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Åžifre</label>
                                <input type="password" id="login-password" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px; margin-bottom: 16px;">
                                GiriÅŸ Yap
                            </button>
                        </form>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <a onclick="currentView='register'; renderCurrentView();" style="color: ${primaryColor}; cursor: pointer; font-size: ${baseSize * 0.85}px; display: block; margin-bottom: 8px;">ÃœyeliÄŸiniz yok mu? Ãœye olmak iÃ§in tÄ±klayÄ±nÄ±z.</a>
                            <a onclick="continueWithoutLogin()" style="color: ${primaryColor}; cursor: pointer; font-size: ${baseSize * 0.85}px; display: block; margin-bottom: 8px;">Ãœye olmadan devam etmek istiyorsanÄ±z tÄ±klayÄ±nÄ±z.</a>
                            <a onclick="showToast('SMS gÃ¶nderildi', 'success')" style="color: ${primaryColor}; cursor: pointer; font-size: ${baseSize * 0.85}px; display: block;">Åžifremi unuttum.</a>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderRegister() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px; overflow-y: auto;">
                    <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 500px; margin: 0 auto;">
                        <h1 style="font-size: ${baseSize * 1.8}px; font-weight: 700; margin-bottom: 24px; text-align: center;">Ãœye Ol</h1>
                        
                        <form onsubmit="handleRegister(event)">
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Ad</label>
                                <input type="text" id="reg-ad" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Soyad</label>
                                <input type="text" id="reg-soyad" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Telefon NumarasÄ±</label>
                                <input type="tel" id="reg-telefon" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">E-mail</label>
                                <input type="email" id="reg-email" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">T.C. Kimlik No</label>
                                <input type="text" id="reg-tc" maxlength="11" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Cinsiyet</label>
                                <select id="reg-cinsiyet" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                    <option value="">SeÃ§iniz</option>
                                    <option value="KadÄ±n">KadÄ±n</option>
                                    <option value="Erkek">Erkek</option>
                                    <option value="Belirtmek istemiyorum">Belirtmek istemiyorum</option>
                                </select>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">KullanÄ±cÄ± AdÄ±</label>
                                <input type="text" id="reg-username" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Åžifre (En az 1 harf ve 1 noktalama iÅŸareti)</label>
                                <input type="password" id="reg-password" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Åžifre Tekrar</label>
                                <input type="password" id="reg-password-confirm" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: flex; align-items: center; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                    <input type="checkbox" id="reg-terms" style="margin-right: 8px;" required>
                                    <span>KullanÄ±m ÅŸartlarÄ±nÄ± kabul ediyorum</span>
                                </label>
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <label style="display: flex; align-items: center; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                    <input type="checkbox" id="reg-kvkk" style="margin-right: 8px;" required>
                                    <span>KVKK/Gizlilik sÃ¶zleÅŸmesini kabul ediyorum</span>
                                </label>
                            </div>
                            
                            <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px; margin-bottom: 12px;">
                                Ãœye Ol
                            </button>
                            
                            <button type="button" onclick="currentView='login'; renderCurrentView();" style="width: 100%; padding: 12px; background: ${surfaceColor}; color: ${secondaryColor}; border: 1px solid ${secondaryColor}; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                Geri DÃ¶n
                            </button>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderDashboard() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 1000px; margin: 0 auto;">
                        <div style="background: ${surfaceColor}; padding: 20px; border-radius: 12px; margin-bottom: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <h1 style="font-size: ${baseSize * 1.3}px; font-weight: 700; margin-bottom: 12px;">HoÅŸ Geldiniz, ${currentUser.ad} ${currentUser.soyad}</h1>
                            <p style="font-size: ${baseSize * 0.9}px; color: ${textColor}; opacity: 0.7; margin-bottom: 16px;">KullanÄ±cÄ± adÄ±: ${currentUser.username}</p>
                            <button onclick="logout()" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                Ã‡Ä±kÄ±ÅŸ Yap
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <h2 style="font-size: ${baseSize * 1.3}px; font-weight: 600; margin-bottom: 16px;">MenÃ¼</h2>
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <button onclick="currentView='past-reservations'; renderCurrentView();" style="padding: 12px; background: ${surfaceColor}; border: 1px solid ${primaryColor}; color: ${primaryColor}; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: ${baseSize * 0.9}px; text-align: left;">
                                    Ã–nceki RezervasyonlarÄ±m
                                </button>
                                <button onclick="currentView='current-reservation'; renderCurrentView();" style="padding: 12px; background: ${surfaceColor}; border: 1px solid ${primaryColor}; color: ${primaryColor}; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: ${baseSize * 0.9}px; text-align: left;">
                                    Åžu Anda Bulunan Rezervasyonum
                                </button>
                                <button onclick="currentView='cancel-reservation'; renderCurrentView();" style="padding: 12px; background: ${surfaceColor}; border: 1px solid ${primaryColor}; color: ${primaryColor}; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: ${baseSize * 0.9}px; text-align: left;">
                                    Rezervasyon Ä°ptali
                                </button>
                                <button onclick="currentView='change-credentials'; renderCurrentView();" style="padding: 12px; background: ${surfaceColor}; border: 1px solid ${primaryColor}; color: ${primaryColor}; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: ${baseSize * 0.9}px; text-align: left;">
                                    Åžifremi / KullanÄ±cÄ± AdÄ±mÄ± DeÄŸiÅŸtir
                                </button>
                                <button onclick="currentView='rooms'; renderCurrentView();" style="padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: ${baseSize}px;">
                                    Rezervasyon Yap
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderRooms() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            const roomsHTML = rooms.map(room => {
                const statusClass = room.status === 'available' ? 'room-available' : 'room-occupied';
                const onclick = room.status === 'available' ? `onclick="makeReservation(${room.number})"` : '';
                return `
                    <div class="room-icon ${statusClass}" ${onclick}>
                        Oda ${room.number}
                    </div>
                `;
            }).join('');
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 1000px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">Oda SeÃ§imi</h1>
                            ${currentUser ? `<button onclick="currentView='dashboard'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">Dashboard</button>` : `<button onclick="currentView='login'; renderCurrentView();" style="padding: 8px 16px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">GiriÅŸ Yap</button>`}
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div style="display: flex; gap: 24px; margin-bottom: 16px; font-size: ${baseSize * 0.9}px;">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <div style="width: 20px; height: 20px; background: #10b981; border-radius: 4px;"></div>
                                    <span>BoÅŸ</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <div style="width: 20px; height: 20px; background: #ef4444; border-radius: 4px;"></div>
                                    <span>Dolu</span>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 20px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 12px;">
                                ${roomsHTML}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderReservation() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px; display: flex; align-items: center; justify-content: center;">
                    <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 500px; width: 100%;">
                        <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700; margin-bottom: 8px;">Rezervasyon - Oda ${window.selectedRoom}</h1>
                        <p style="font-size: ${baseSize * 0.9}px; color: ${textColor}; opacity: 0.7; margin-bottom: 32px;">Rezervasyon bilgilerini giriniz</p>
                        
                        <form onsubmit="submitReservation(event)">
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">KaÃ§ kiÅŸi kalacaksÄ±nÄ±z?</label>
                                <input type="number" id="guest-count" min="1" max="10" value="2" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">GiriÅŸ Saati</label>
                                <input type="datetime-local" id="check-in" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Ã‡Ä±kÄ±ÅŸ Saati</label>
                                <input type="datetime-local" id="check-out" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px; margin-bottom: 12px;">
                                Devam Et
                            </button>
                            
                            <button type="button" onclick="currentView='rooms'; renderCurrentView();" style="width: 100%; padding: 12px; background: ${surfaceColor}; color: ${secondaryColor}; border: 1px solid ${secondaryColor}; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                Geri DÃ¶n
                            </button>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderPayment() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px; display: flex; align-items: center; justify-content: center;">
                    <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 500px; width: 100%;">
                        <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700; margin-bottom: 24px;">Ã–deme</h1>
                        
                        <div style="background: ${bgColor}; padding: 20px; border-radius: 8px; margin-bottom: 24px;">
                            <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; margin-bottom: 12px;">Rezervasyon Ã–zeti</h3>
                            <div style="font-size: ${baseSize * 0.9}px; color: ${textColor}; opacity: 0.8;">
                                <p style="margin-bottom: 8px;">Oda: ${window.pendingReservation.room_number}</p>
                                <p style="margin-bottom: 8px;">KiÅŸi SayÄ±sÄ±: ${window.pendingReservation.guest_count}</p>
                                <p style="margin-bottom: 8px;">SÃ¼re: ${window.pendingReservation.hours} saat</p>
                                <p style="font-size: ${baseSize * 1.3}px; font-weight: 700; margin-top: 16px; color: ${primaryColor};">
                                    Toplam: ${window.pendingReservation.price} â‚º
                                </p>
                            </div>
                        </div>
                        
                        <form onsubmit="processPayment(event)">
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Kart NumarasÄ±</label>
                                <input type="text" id="card-number" maxlength="16" placeholder="1234 5678 9012 3456" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 24px;">
                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Son Kullanma</label>
                                    <input type="text" id="expiry" placeholder="MM/YY" maxlength="5" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">CVV</label>
                                    <input type="text" id="cvv" maxlength="3" placeholder="123" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                </div>
                            </div>
                            
                            <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px; margin-bottom: 12px;">
                                Ã–demeyi Tamamla
                            </button>
                            
                            <button type="button" onclick="currentView='reservation'; renderCurrentView();" style="width: 100%; padding: 12px; background: ${surfaceColor}; color: ${secondaryColor}; border: 1px solid ${secondaryColor}; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                Geri DÃ¶n
                            </button>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderTicket() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            
            const ticket = window.currentTicket;
            const checkIn = new Date(ticket.check_in).toLocaleString('tr-TR');
            const checkOut = new Date(ticket.check_out).toLocaleString('tr-TR');
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px; display: flex; align-items: center; justify-content: center;">
                    <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 500px; width: 100%; text-align: center;">
                        <div style="font-size: ${baseSize * 2.5}px; margin-bottom: 12px;">ðŸŽ‰</div>
                        <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700; margin-bottom: 12px; color: ${primaryColor};">Rezervasyon BaÅŸarÄ±lÄ±!</h1>
                        
                        <div class="qr-code" style="margin: 24px auto;">
                            <svg width="180" height="180" viewBox="0 0 180 180">
                                <rect width="180" height="180" fill="white"/>
                                <rect x="20" y="20" width="20" height="20" fill="black"/>
                                <rect x="60" y="20" width="20" height="20" fill="black"/>
                                <rect x="100" y="20" width="20" height="20" fill="black"/>
                                <rect x="140" y="20" width="20" height="20" fill="black"/>
                                <rect x="20" y="60" width="20" height="20" fill="black"/>
                                <rect x="140" y="60" width="20" height="20" fill="black"/>
                                <rect x="20" y="100" width="20" height="20" fill="black"/>
                                <rect x="60" y="100" width="20" height="20" fill="black"/>
                                <rect x="100" y="100" width="20" height="20" fill="black"/>
                                <rect x="140" y="100" width="20" height="20" fill="black"/>
                                <rect x="20" y="140" width="20" height="20" fill="black"/>
                                <rect x="60" y="140" width="20" height="20" fill="black"/>
                                <rect x="100" y="140" width="20" height="20" fill="black"/>
                                <rect x="140" y="140" width="20" height="20" fill="black"/>
                            </svg>
                        </div>
                        
                        <div style="background: ${bgColor}; padding: 20px; border-radius: 8px; margin-top: 24px; text-align: left;">
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 12px;"><strong>Bilet NumarasÄ±:</strong> ${ticket.ticket_number}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 12px;"><strong>Oda:</strong> ${ticket.room_number}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 12px;"><strong>KiÅŸi SayÄ±sÄ±:</strong> ${ticket.guest_count}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 12px;"><strong>GiriÅŸ:</strong> ${checkIn}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 12px;"><strong>Ã‡Ä±kÄ±ÅŸ:</strong> ${checkOut}</p>
                            <p style="font-size: ${baseSize * 1.1}px; margin-top: 16px; color: ${primaryColor}; font-weight: 700;"><strong>Ãœcret:</strong> ${ticket.price} â‚º</p>
                        </div>
                        
                        <p style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7; margin-top: 20px;">
                            QR kodu kapÄ± okuyucusuna gÃ¶stererek odaya girebilirsiniz
                        </p>
                        
                        <button onclick="currentView='room-control'; renderCurrentView();" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px; margin-top: 24px;">
                            Oda Kontrol Paneli
                        </button>
                    </div>
                </div>
            `;
        }

        function renderRoomControl() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 600px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">Oda Kontrol</h1>
                            <button onclick="currentView='dashboard'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                Dashboard
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; margin-bottom: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                <div>
                                    <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; margin-bottom: 4px;">ðŸ’¡ IÅŸÄ±k KontrolÃ¼</h3>
                                    <p style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7;">Oda aydÄ±nlatmasÄ±nÄ± kontrol edin</p>
                                </div>
                                <label style="position: relative; display: inline-block; width: 60px; height: 34px;">
                                    <input type="checkbox" id="light-control" style="opacity: 0; width: 0; height: 0;">
                                    <span onclick="toggleLight()" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #ccc; border-radius: 34px; transition: 0.4s;"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; margin-bottom: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                <div>
                                    <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; margin-bottom: 4px;">â„ï¸ Klima KontrolÃ¼</h3>
                                    <p style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7;">Oda sÄ±caklÄ±ÄŸÄ±nÄ± ayarlayÄ±n</p>
                                </div>
                                <label style="position: relative; display: inline-block; width: 60px; height: 34px;">
                                    <input type="checkbox" id="ac-control" style="opacity: 0; width: 0; height: 0;">
                                    <span onclick="toggleAC()" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #ccc; border-radius: 34px; transition: 0.4s;"></span>
                                </label>
                            </div>
                            <div id="ac-temp" style="display: none;">
                                <input type="range" min="16" max="30" value="22" id="temp-slider" oninput="updateTemp(this.value)" style="width: 100%; margin-top: 12px;">
                                <p style="text-align: center; margin-top: 8px; font-size: ${baseSize * 1.1}px; font-weight: 600;" id="temp-display">22Â°C</p>
                            </div>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; margin-bottom: 12px;">ðŸšª KapÄ± KontrolÃ¼</h3>
                            <p style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7; margin-bottom: 16px;">QR kodunuzu okutarak kapÄ±yÄ± aÃ§abilirsiniz</p>
                            <button onclick="openDoor()" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                KapÄ±yÄ± AÃ§
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function toggleLight() {
            const checkbox = document.getElementById('light-control');
            const span = checkbox.nextElementSibling;
            checkbox.checked = !checkbox.checked;
            span.style.background = checkbox.checked ? '#3b82f6' : '#ccc';
            showToast(checkbox.checked ? 'IÅŸÄ±k aÃ§Ä±ldÄ±' : 'IÅŸÄ±k kapatÄ±ldÄ±', 'success');
        }

        function toggleAC() {
            const checkbox = document.getElementById('ac-control');
            const span = checkbox.nextElementSibling;
            const tempDiv = document.getElementById('ac-temp');
            checkbox.checked = !checkbox.checked;
            span.style.background = checkbox.checked ? '#3b82f6' : '#ccc';
            tempDiv.style.display = checkbox.checked ? 'block' : 'none';
            showToast(checkbox.checked ? 'Klima aÃ§Ä±ldÄ±' : 'Klima kapatÄ±ldÄ±', 'success');
        }

        function updateTemp(value) {
            document.getElementById('temp-display').textContent = value + 'Â°C';
        }

        function openDoor() {
            showToast('KapÄ± aÃ§Ä±lÄ±yor...', 'success');
            setTimeout(() => {
                showToast('KapÄ± aÃ§Ä±ldÄ±! LÃ¼tfen iÃ§eri giriniz', 'success');
            }, 1500);
        }

        function renderCurrentView() {
            const app = document.getElementById('app');
            
            switch(currentView) {
                case 'login':
                    app.innerHTML = renderLogin();
                    break;
                case 'register':
                    app.innerHTML = renderRegister();
                    break;
                case 'dashboard':
                    app.innerHTML = renderDashboard();
                    break;
                case 'rooms':
                    app.innerHTML = renderRooms();
                    break;
                case 'reservation':
                    app.innerHTML = renderReservation();
                    break;
                case 'payment':
                    app.innerHTML = renderPayment();
                    break;
                case 'ticket':
                    app.innerHTML = renderTicket();
                    break;
                case 'room-control':
                    app.innerHTML = renderRoomControl();
                    break;
                case 'past-reservations':
                    renderPastReservations();
                    break;
                case 'current-reservation':
                    renderCurrentReservation();
                    break;
                case 'cancel-reservation':
                    renderCancelReservation();
                    break;
                case 'change-credentials':
                    renderChangeCredentials();
                    break;
                default:
                    app.innerHTML = renderLogin();
            }
        }

        function renderPastReservations() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            const { past } = getUserReservations();
            const app = document.getElementById('app');
            
            let content = '';
            
            if (past.length === 0) {
                content = `
                    <div style="text-align: center; padding: 40px;">
                        <p style="font-size: ${baseSize * 1.1}px; color: ${textColor}; opacity: 0.7;">Herhangi bir geÃ§miÅŸ rezervasyonunuz bulunmamaktadÄ±r.</p>
                    </div>
                `;
            } else {
                content = past.map(res => `
                    <div style="background: ${bgColor}; padding: 20px; border-radius: 8px; margin-bottom: 16px;">
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Oda:</strong> ${res.room_number}</p>
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>GiriÅŸ:</strong> ${new Date(res.check_in).toLocaleString('tr-TR')}</p>
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Ã‡Ä±kÄ±ÅŸ:</strong> ${new Date(res.check_out).toLocaleString('tr-TR')}</p>
                        <p style="font-size: ${baseSize * 0.9}px;"><strong>Ãœcret:</strong> ${res.price} â‚º</p>
                    </div>
                `).join('');
            }
            
            app.innerHTML = `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 800px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">Ã–nceki RezervasyonlarÄ±m</h1>
                            <button onclick="currentView='dashboard'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                Geri DÃ¶n
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            ${content}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCurrentReservation() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            const { active } = getUserReservations();
            const app = document.getElementById('app');
            
            let content = '';
            
            if (!active) {
                content = `
                    <div style="text-align: center; padding: 40px;">
                        <p style="font-size: ${baseSize * 1.1}px; color: ${textColor}; opacity: 0.7;">Aktif rezervasyonunuz bulunmamaktadÄ±r.</p>
                    </div>
                `;
            } else {
                const now = new Date();
                const checkIn = new Date(active.check_in);
                const isCheckedIn = now >= checkIn;
                
                content = `
                    <div style="background: ${bgColor}; padding: 20px; border-radius: 8px; margin-bottom: 16px;">
                        ${isCheckedIn ? `<div style="background: ${primaryColor}; color: white; padding: 12px; border-radius: 6px; margin-bottom: 16px; text-align: center; font-weight: 600;">Odaya giriÅŸ yaptÄ±ÄŸÄ±nÄ±z tespit edildi. Åžu anda konaklamaktasÄ±nÄ±z.</div>` : ''}
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Oda:</strong> ${active.room_number}</p>
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>GiriÅŸ:</strong> ${checkIn.toLocaleString('tr-TR')}</p>
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Ã‡Ä±kÄ±ÅŸ:</strong> ${new Date(active.check_out).toLocaleString('tr-TR')}</p>
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 16px;"><strong>Ãœcret:</strong> ${active.price} â‚º</p>
                        ${isCheckedIn ? `<button onclick="currentView='room-control'; renderCurrentView();" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">Oda Kontrol Paneli</button>` : ''}
                    </div>
                `;
            }
            
            app.innerHTML = `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 800px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">Aktif Rezervasyonum</h1>
                            <button onclick="currentView='dashboard'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                Geri DÃ¶n
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            ${content}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCancelReservation() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            const { active, cancelled } = getUserReservations();
            const app = document.getElementById('app');
            
            let cancelledContent = '';
            if (cancelled.length > 0) {
                cancelledContent = `
                    <div style="margin-bottom: 32px;">
                        <h2 style="font-size: ${baseSize * 1.3}px; font-weight: 600; margin-bottom: 16px;">Ä°ptal Edilen Rezervasyonlar</h2>
                        ${cancelled.map(res => `
                            <div style="background: ${bgColor}; padding: 16px; border-radius: 8px; margin-bottom: 12px;">
                                <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Oda:</strong> ${res.room_number}</p>
                                <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Ä°ptal Tarihi:</strong> ${new Date(res.cancelled_at).toLocaleString('tr-TR')}</p>
                                <p style="font-size: ${baseSize * 0.9}px;"><strong>Ä°ptal Nedeni:</strong> ${res.cancellation_reason || 'Belirtilmedi'}</p>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            let activeContent = '';
            if (active) {
                activeContent = `
                    <div>
                        <h2 style="font-size: ${baseSize * 1.3}px; font-weight: 600; margin-bottom: 16px;">Rezervasyonunuzu Ä°ptal Et</h2>
                        <div style="background: ${bgColor}; padding: 20px; border-radius: 8px; margin-bottom: 16px;">
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Oda:</strong> ${active.room_number}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>GiriÅŸ:</strong> ${new Date(active.check_in).toLocaleString('tr-TR')}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 16px;"><strong>Ã‡Ä±kÄ±ÅŸ:</strong> ${new Date(active.check_out).toLocaleString('tr-TR')}</p>
                        </div>
                        
                        <form onsubmit="event.preventDefault(); const reason = document.getElementById('cancel-reason').value; cancelReservation('${active.id}', reason);">
                            <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Ä°ptal Nedeni</label>
                            <textarea id="cancel-reason" rows="4" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px; margin-bottom: 16px; resize: vertical;" placeholder="Ä°ptal nedeninizi belirtiniz (isteÄŸe baÄŸlÄ±)"></textarea>
                            <button type="submit" style="width: 100%; padding: 12px; background: #ef4444; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                Rezervasyonu Ä°ptal Et
                            </button>
                        </form>
                    </div>
                `;
            } else {
                activeContent = `
                    <div style="text-align: center; padding: 40px;">
                        <p style="font-size: ${baseSize * 1.1}px; color: ${textColor}; opacity: 0.7;">Ä°ptal edilebilecek aktif rezervasyonunuz bulunmamaktadÄ±r.</p>
                    </div>
                `;
            }
            
            app.innerHTML = `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 800px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">Rezervasyon Ä°ptali</h1>
                            <button onclick="currentView='dashboard'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                Geri DÃ¶n
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            ${cancelledContent}
                            ${activeContent}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderChangeCredentials() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            const app = document.getElementById('app');
            
            app.innerHTML = `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 600px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">Bilgilerimi DeÄŸiÅŸtir</h1>
                            <button onclick="currentView='dashboard'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                Geri DÃ¶n
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; margin-bottom: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <h2 style="font-size: ${baseSize * 1.3}px; font-weight: 600; margin-bottom: 16px;">Åžifre DeÄŸiÅŸtir</h2>
                            <form onsubmit="event.preventDefault(); changePassword();">
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Mevcut Åžifre</label>
                                    <input type="password" id="current-password" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                </div>
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Yeni Åžifre (En az 1 harf ve 1 noktalama iÅŸareti)</label>
                                    <input type="password" id="new-password" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                </div>
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Yeni Åžifre Tekrar</label>
                                    <input type="password" id="new-password-confirm" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                </div>
                                <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                    Åžifreyi DeÄŸiÅŸtir
                                </button>
                            </form>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <h2 style="font-size: ${baseSize * 1.3}px; font-weight: 600; margin-bottom: 16px;">KullanÄ±cÄ± AdÄ± DeÄŸiÅŸtir</h2>
                            <form onsubmit="event.preventDefault(); changeUsername();">
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Mevcut KullanÄ±cÄ± AdÄ±</label>
                                    <input type="text" value="${currentUser.username}" disabled style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px; background: ${bgColor};">
                                </div>
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Yeni KullanÄ±cÄ± AdÄ±</label>
                                    <input type="text" id="new-username" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                </div>
                                <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                    KullanÄ±cÄ± AdÄ±nÄ± DeÄŸiÅŸtir
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            `;
        }

        function changePassword() {
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const newPasswordConfirm = document.getElementById('new-password-confirm').value;
            
            if (currentPassword !== currentUser.password) {
                showToast('Mevcut ÅŸifre hatalÄ±', 'error');
                return;
            }
            
            if (!validatePassword(newPassword)) {
                showToast('Yeni ÅŸifre en az 1 harf ve 1 noktalama iÅŸareti iÃ§ermelidir', 'error');
                return;
            }
            
            if (newPassword !== newPasswordConfirm) {
                showToast('Yeni ÅŸifreler eÅŸleÅŸmiyor', 'error');
                return;
            }
            
            currentUser.password = newPassword;
            updateUser(currentUser);
            showToast('Åžifre baÅŸarÄ±yla deÄŸiÅŸtirildi', 'success');
            currentView = 'dashboard';
            renderCurrentView();
        }

        function changeUsername() {
            const newUsername = document.getElementById('new-username').value;
            
            const users = getUsers();
            const existingUser = users.find(u => u.username === newUsername && u.id !== currentUser.id);
            
            if (existingUser) {
                showToast('Bu kullanÄ±cÄ± adÄ± zaten kullanÄ±lÄ±yor', 'error');
                return;
            }
            
            currentUser.username = newUsername;
            updateUser(currentUser);
            showToast('KullanÄ±cÄ± adÄ± baÅŸarÄ±yla deÄŸiÅŸtirildi', 'success');
            currentView = 'dashboard';
            renderCurrentView();
        }

        async function onConfigChange(config) {
            const customFont = config.font_family || defaultConfig.font_family;
            const baseSize = config.font_size || defaultConfig.font_size;
            const bgColor = config.background_color || defaultConfig.background_color;
            const surfaceColor = config.surface_color || defaultConfig.surface_color;
            const textColor = config.text_color || defaultConfig.text_color;
            
            document.body.style.fontFamily = `${customFont}, system-ui, sans-serif`;
            document.body.style.fontSize = `${baseSize}px`;
            document.body.style.color = textColor;
            
            renderCurrentView();
        }

        function init() {
            updateRoomStatus();
            
            if (window.elementSdk) {
                window.elementSdk.init({
                    defaultConfig,
                    onConfigChange,
                    mapToCapabilities: (config) => ({
                        recolorables: [
                            {
                                get: () => config.background_color || defaultConfig.background_color,
                                set: (value) => {
                                    config.background_color = value;
                                    window.elementSdk.setConfig({ background_color: value });
                                }
                            },
                            {
                                get: () => config.surface_color || defaultConfig.surface_color,
                                set: (value) => {
                                    config.surface_color = value;
                                    window.elementSdk.setConfig({ surface_color: value });
                                }
                            },
                            {
                                get: () => config.text_color || defaultConfig.text_color,
                                set: (value) => {
                                    config.text_color = value;
                                    window.elementSdk.setConfig({ text_color: value });
                                }
                            },
                            {
                                get: () => config.primary_action_color || defaultConfig.primary_action_color,
                                set: (value) => {
                                    config.primary_action_color = value;
                                    window.elementSdk.setConfig({ primary_action_color: value });
                                }
                            },
                            {
                                get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
                                set: (value) => {
                                    config.secondary_action_color = value;
                                    window.elementSdk.setConfig({ secondary_action_color: value });
                                }
                            }
                        ],
                        borderables: [],
                        fontEditable: {
                            get: () => config.font_family || defaultConfig.font_family,
                            set: (value) => {
                                config.font_family = value;
                                window.elementSdk.setConfig({ font_family: value });
                            }
                        },
                        fontSizeable: {
                            get: () => config.font_size || defaultConfig.font_size,
                            set: (value) => {
                                config.font_size = value;
                                window.elementSdk.setConfig({ font_size: value });
                            }
                        }
                    }),
                    mapToEditPanelValues: (config) => new Map([
                        ['app_title', config.app_title || defaultConfig.app_title],
                        ['welcome_message', config.welcome_message || defaultConfig.welcome_message],
                        ['support_phone', config.support_phone || defaultConfig.support_phone],
                        ['support_email', config.support_email || defaultConfig.support_email]
                    ])
                });
            }
            
            renderCurrentView();
        }

        init();
    </script>

<script>
window.addEventListener("DOMContentLoaded", () => {
    renderCurrentView();
});
</script>

 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9aaeeb8a15beed1e',t:'MTc2NTIyNDc3Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
