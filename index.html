<!doctype html>
<html lang="tr" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Akƒ±llƒ± Ev Kiralama Sistemi</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .room-icon {
            width: 80px;
            height: 80px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .room-icon {
                width: 65px;
                height: 65px;
                font-size: 12px;
            }
        }
        
        .room-available {
            background: #10b981;
            color: white;
        }
        
        .room-available:hover {
            background: #059669;
            transform: scale(1.05);
        }
        
        .room-occupied {
            background: #ef4444;
            color: white;
            cursor: not-allowed;
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 999;
        }
        
        .qr-code {
            width: 200px;
            height: 200px;
            background: white;
            border: 2px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }

        .location-card {
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .location-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .location-card.selected {
            border-color: #3b82f6;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app" class="h-full w-full"></div>
  <script>
        const defaultConfig = {
            app_title: "Akƒ±llƒ± Ev Kiralama Sistemi",
            welcome_message: "Akƒ±llƒ± ev kiralama sistemine ho≈ü geldiniz",
            support_phone: "0850 XXX XX XX",
            support_email: "destek@akilliev.com",
            background_color: "#f3f4f6",
            surface_color: "#ffffff",
            text_color: "#1f2937",
            primary_action_color: "#3b82f6",
            secondary_action_color: "#6b7280",
            font_family: "system-ui",
            font_size: 16
        };

        let currentUser = null;
        let currentView = 'login';
        let selectedLocation = null;
        let selectedDateRange = null;
        let availableRooms = [];

        // Konaklama noktalarƒ±
        const locations = [
            { id: 1, name: "Road 96 Otoyolu - ƒ∞stanbul Konaklama", city: "ƒ∞stanbul", highway: "Road 96", roomCount: 10 },
            { id: 2, name: "Road 96 Otoyolu - Ankara Konaklama", city: "Ankara", highway: "Road 96", roomCount: 8 },
            { id: 3, name: "Road 96 Otoyolu - ƒ∞zmir Konaklama", city: "ƒ∞zmir", highway: "Road 96", roomCount: 12 },
            { id: 4, name: "E80 Otoyolu - Bursa Konaklama", city: "Bursa", highway: "E80", roomCount: 10 },
            { id: 5, name: "E90 Otoyolu - Antalya Konaklama", city: "Antalya", highway: "E90", roomCount: 15 }
        ];

        // Her konum i√ßin odalar
        const allRooms = {};
        locations.forEach(loc => {
            allRooms[loc.id] = [];
            for (let i = 1; i <= loc.roomCount; i++) {
                allRooms[loc.id].push({
                    id: `${loc.id}-${i}`,
                    locationId: loc.id,
                    number: i,
                    reservations: []
                });
            }
        });

        // LocalStorage helper functions
        function getUsers() {
            const users = localStorage.getItem('users');
            return users ? JSON.parse(users) : [];
        }

        function saveUser(user) {
            const users = getUsers();
            users.push(user);
            localStorage.setItem('users', JSON.stringify(users));
        }

        function updateUser(updatedUser) {
            const users = getUsers();
            const index = users.findIndex(u => u.id === updatedUser.id);
            if (index !== -1) {
                users[index] = updatedUser;
                localStorage.setItem('users', JSON.stringify(users));
            }
        }

        function getReservations() {
            const reservations = localStorage.getItem('reservations');
            return reservations ? JSON.parse(reservations) : [];
        }

        function saveReservation(reservation) {
            const reservations = getReservations();
            reservations.push(reservation);
            localStorage.setItem('reservations', JSON.stringify(reservations));
        }

        function updateReservation(updatedReservation) {
            const reservations = getReservations();
            const index = reservations.findIndex(r => r.id === updatedReservation.id);
            if (index !== -1) {
                reservations[index] = updatedReservation;
                localStorage.setItem('reservations', JSON.stringify(reservations));
            }
        }

        function checkRoomAvailability(locationId, checkIn, checkOut) {
            const reservations = getReservations();
            const requestStart = new Date(checkIn);
            const requestEnd = new Date(checkOut);
            
            const available = [];
            const rooms = allRooms[locationId];
            
            rooms.forEach(room => {
                const roomReservations = reservations.filter(r => 
                    r.room_id === room.id && 
                    r.status === 'active'
                );
                
                let isAvailable = true;
                roomReservations.forEach(res => {
                    const resStart = new Date(res.check_in);
                    const resEnd = new Date(res.check_out);
                    
                    // √áakƒ±≈üma kontrol√º
                    if (!(requestEnd <= resStart || requestStart >= resEnd)) {
                        isAvailable = false;
                    }
                });
                
                if (isAvailable) {
                    available.push(room);
                }
            });
            
            return available;
        }

        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.style.background = type === 'error' ? '#fee2e2' : type === 'success' ? '#d1fae5' : '#dbeafe';
            toast.style.color = type === 'error' ? '#991b1b' : type === 'success' ? '#065f46' : '#1e40af';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        function validatePassword(password) {
            const hasLetter = /[a-zA-Z]/.test(password);
            const hasPunctuation = /[!@#$%^&*(),.?":{}|<>]/.test(password);
            return hasLetter && hasPunctuation;
        }

        function validateTCKimlik(tc) {
            return tc.length === 11 && /^\d+$/.test(tc);
        }

        function handleLogin(e) {
            e.preventDefault();
            const tcKimlik = document.getElementById('login-tc').value;
            const password = document.getElementById('login-password').value;
            
            if (!validateTCKimlik(tcKimlik)) {
                showToast('Ge√ßerli bir T.C. Kimlik No giriniz', 'error');
                return;
            }
            
            const users = getUsers();
            const user = users.find(u => u.tc_kimlik === tcKimlik && u.password === password);
            
            if (user) {
                currentUser = user;
                currentView = 'dashboard';
                renderCurrentView();
                showToast('Giri≈ü ba≈üarƒ±lƒ±!', 'success');
            } else {
                showToast('T.C. Kimlik No veya ≈üifre hatalƒ±', 'error');
            }
        }

        function handleRegister(e) {
            e.preventDefault();
            
            const ad = document.getElementById('reg-ad').value;
            const soyad = document.getElementById('reg-soyad').value;
            const telefon = document.getElementById('reg-telefon').value;
            const email = document.getElementById('reg-email').value;
            const tcKimlik = document.getElementById('reg-tc').value;
            const cinsiyet = document.getElementById('reg-cinsiyet').value;
            const username = document.getElementById('reg-username').value;
            const password = document.getElementById('reg-password').value;
            const passwordConfirm = document.getElementById('reg-password-confirm').value;
            const kvkkAccept = document.getElementById('reg-kvkk').checked;
            const termsAccept = document.getElementById('reg-terms').checked;
            
            if (!validateTCKimlik(tcKimlik)) {
                showToast('Ge√ßerli bir T.C. Kimlik No giriniz', 'error');
                return;
            }
            
            if (!validatePassword(password)) {
                showToast('≈ûifre en az 1 harf ve 1 noktalama i≈üareti i√ßermelidir', 'error');
                return;
            }
            
            if (password !== passwordConfirm) {
                showToast('≈ûifreler e≈üle≈ümiyor', 'error');
                return;
            }
            
            if (!kvkkAccept || !termsAccept) {
                showToast('Kullanƒ±m ≈üartlarƒ± ve KVKK onayƒ± zorunludur', 'error');
                return;
            }
            
            const users = getUsers();
            const existingUser = users.find(u => u.username === username);
            
            if (existingUser) {
                showToast('Bu kullanƒ±cƒ± adƒ± zaten alƒ±nmƒ±≈ü', 'error');
                return;
            }
            
            const newUser = {
                id: Date.now().toString(),
                tc_kimlik: tcKimlik,
                username,
                password,
                ad,
                soyad,
                telefon,
                email,
                cinsiyet,
                created_at: new Date().toISOString()
            };
            
            saveUser(newUser);
            showToast('√úyelik ba≈üarƒ±yla olu≈üturuldu!', 'success');
            currentView = 'login';
            renderCurrentView();
        }

        function continueWithoutLogin() {
            currentUser = null;
            currentView = 'location-select';
            renderCurrentView();
        }

        function logout() {
            currentUser = null;
            currentView = 'login';
            renderCurrentView();
        }

        function selectLocation(locationId) {
            selectedLocation = locations.find(l => l.id === locationId);
            currentView = 'date-select';
            renderCurrentView();
        }

        function searchAvailableRooms(e) {
            e.preventDefault();
            
            const checkIn = document.getElementById('check-in').value;
            const checkOut = document.getElementById('check-out').value;
            
            if (!checkIn || !checkOut) {
                showToast('L√ºtfen giri≈ü ve √ßƒ±kƒ±≈ü tarihlerini giriniz', 'error');
                return;
            }
            
            const checkInDate = new Date(checkIn);
            const checkOutDate = new Date(checkOut);
            
            if (checkOutDate <= checkInDate) {
                showToast('√áƒ±kƒ±≈ü tarihi giri≈ü tarihinden sonra olmalƒ±dƒ±r', 'error');
                return;
            }
            
            selectedDateRange = { checkIn, checkOut };
            availableRooms = checkRoomAvailability(selectedLocation.id, checkIn, checkOut);
            
            if (availableRooms.length === 0) {
                showToast('Se√ßilen tarih aralƒ±ƒüƒ±nda bo≈ü oda bulunmamaktadƒ±r', 'error');
                return;
            }
            
            currentView = 'available-rooms';
            renderCurrentView();
        }

        function selectRoom(roomId) {
            if (!currentUser) {
                showToast('Rezervasyon yapmak i√ßin l√ºtfen giri≈ü yapƒ±nƒ±z', 'error');
                currentView = 'login';
                renderCurrentView();
                return;
            }
            
            const room = availableRooms.find(r => r.id === roomId);
            window.selectedRoom = room;
            currentView = 'reservation-details';
            renderCurrentView();
        }

        function submitReservation(e) {
            e.preventDefault();
            
            const guestCount = document.getElementById('guest-count').value;
            
            const checkInDate = new Date(selectedDateRange.checkIn);
            const checkOutDate = new Date(selectedDateRange.checkOut);
            
            const hours = (checkOutDate - checkInDate) / (1000 * 60 * 60);
            const price = hours * 100;
            
            window.pendingReservation = {
                room: window.selectedRoom,
                guest_count: guestCount,
                check_in: selectedDateRange.checkIn,
                check_out: selectedDateRange.checkOut,
                hours: hours.toFixed(1),
                price: price,
                location: selectedLocation
            };
            
            currentView = 'payment';
            renderCurrentView();
        }

        function processPayment(e) {
            e.preventDefault();
            
            const cardNumber = document.getElementById('card-number').value;
            const cvv = document.getElementById('cvv').value;
            const expiry = document.getElementById('expiry').value;
            
            if (!cardNumber || !cvv || !expiry) {
                showToast('T√ºm kart bilgilerini giriniz', 'error');
                return;
            }
            
            const reservation = {
                id: Date.now().toString(),
                user_id: currentUser.id,
                room_id: window.pendingReservation.room.id,
                room_number: window.pendingReservation.room.number,
                location_id: window.pendingReservation.location.id,
                location_name: window.pendingReservation.location.name,
                guest_count: window.pendingReservation.guest_count,
                check_in: window.pendingReservation.check_in,
                check_out: window.pendingReservation.check_out,
                price: window.pendingReservation.price,
                status: 'active',
                ticket_number: 'TKT' + Date.now(),
                created_at: new Date().toISOString()
            };
            
            saveReservation(reservation);
            window.currentTicket = reservation;
            currentView = 'ticket';
            renderCurrentView();
            showToast('√ñdeme ba≈üarƒ±lƒ±!', 'success');
        }

        function getUserReservations() {
            if (!currentUser) return { active: null, past: [], cancelled: [] };
            
            const now = new Date();
            const reservations = getReservations();
            const userReservations = reservations.filter(r => r.user_id === currentUser.id);
            
            const active = userReservations.find(r => 
                r.status === 'active' && new Date(r.check_out) > now
            );
            
            const past = userReservations.filter(r => 
                r.status === 'active' && new Date(r.check_out) <= now
            );
            
            const cancelled = userReservations.filter(r => r.status === 'cancelled');
            
            return { active, past, cancelled };
        }

        function cancelReservation(reservationId, reason) {
            const reservations = getReservations();
            const reservation = reservations.find(r => r.id === reservationId);
            if (!reservation) return;
            
            reservation.status = 'cancelled';
            reservation.cancellation_reason = reason;
            reservation.cancelled_at = new Date().toISOString();
            
            updateReservation(reservation);
            showToast('Rezervasyon iptal edildi', 'success');
            currentView = 'dashboard';
            renderCurrentView();
        }

        function renderLogin() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const appTitle = window.elementSdk?.config?.app_title || defaultConfig.app_title;
            const welcomeMsg = window.elementSdk?.config?.welcome_message || defaultConfig.welcome_message;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; display: flex; align-items: center; justify-content: center; padding: 16px;">
                    <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 400px; width: 100%;">
                        <h1 style="font-size: ${baseSize * 1.8}px; font-weight: 700; margin-bottom: 8px; text-align: center;">${appTitle}</h1>
                        <p style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7; text-align: center; margin-bottom: 24px;">${welcomeMsg}</p>
                        
                        <form onsubmit="handleLogin(event)">
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">T.C. Kimlik No</label>
                                <input type="text" id="login-tc" maxlength="11" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">≈ûifre</label>
                                <input type="password" id="login-password" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px; margin-bottom: 16px;">
                                Giri≈ü Yap
                            </button>
                        </form>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <a onclick="currentView='register'; renderCurrentView();" style="color: ${primaryColor}; cursor: pointer; font-size: ${baseSize * 0.85}px; display: block; margin-bottom: 8px;">√úyeliƒüiniz yok mu? √úye olmak i√ßin tƒ±klayƒ±nƒ±z.</a>
                            <a onclick="continueWithoutLogin()" style="color: ${primaryColor}; cursor: pointer; font-size: ${baseSize * 0.85}px; display: block; margin-bottom: 8px;">√úye olmadan devam etmek istiyorsanƒ±z tƒ±klayƒ±nƒ±z.</a>
                            <a onclick="showToast('SMS g√∂nderildi', 'success')" style="color: ${primaryColor}; cursor: pointer; font-size: ${baseSize * 0.85}px; display: block;">≈ûifremi unuttum.</a>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderRegister() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px; overflow-y: auto;">
                    <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 500px; margin: 0 auto;">
                        <h1 style="font-size: ${baseSize * 1.8}px; font-weight: 700; margin-bottom: 24px; text-align: center;">√úye Ol</h1>
                        
                        <form onsubmit="handleRegister(event)">
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Ad</label>
                                <input type="text" id="reg-ad" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Soyad</label>
                                <input type="text" id="reg-soyad" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Telefon Numarasƒ±</label>
                                <input type="tel" id="reg-telefon" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">E-mail</label>
                                <input type="email" id="reg-email" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">T.C. Kimlik No</label>
                                <input type="text" id="reg-tc" maxlength="11" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Cinsiyet</label>
                                <select id="reg-cinsiyet" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                    <option value="">Se√ßiniz</option>
                                    <option value="Kadƒ±n">Kadƒ±n</option>
                                    <option value="Erkek">Erkek</option>
                                    <option value="Belirtmek istemiyorum">Belirtmek istemiyorum</option>
                                </select>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Kullanƒ±cƒ± Adƒ±</label>
                                <input type="text" id="reg-username" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">≈ûifre (En az 1 harf ve 1 noktalama i≈üareti)</label>
                                <input type="password" id="reg-password" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">≈ûifre Tekrar</label>
                                <input type="password" id="reg-password-confirm" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: flex; align-items: center; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                    <input type="checkbox" id="reg-terms" style="margin-right: 8px;" required>
                                    <span>Kullanƒ±m ≈üartlarƒ±nƒ± kabul ediyorum</span>
                                </label>
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <label style="display: flex; align-items: center; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                    <input type="checkbox" id="reg-kvkk" style="margin-right: 8px;" required>
                                    <span>KVKK/Gizlilik s√∂zle≈ümesini kabul ediyorum</span>
                                </label>
                            </div>
                            
                            <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px; margin-bottom: 12px;">
                                √úye Ol
                            </button>
                            
                            <button type="button" onclick="currentView='login'; renderCurrentView();" style="width: 100%; padding: 12px; background: ${surfaceColor}; color: ${secondaryColor}; border: 1px solid ${secondaryColor}; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                Geri D√∂n
                            </button>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderLocationSelect() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            const locationsHTML = locations.map(loc => `
                <div class="location-card" onclick="selectLocation(${loc.id})" style="background: ${surfaceColor}; padding: 20px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                    <div style="display: flex; align-items: center; margin-bottom: 12px;">
                        <div style="font-size: ${baseSize * 2}px; margin-right: 12px;">üè†</div>
                        <div style="flex: 1;">
                            <h3 style="font-size: ${baseSize * 1.1}px; font-weight: 600; margin-bottom: 4px;">${loc.name}</h3>
                            <p style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7;">${loc.city} - ${loc.highway}</p>
                        </div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 12px; border-top: 1px solid ${bgColor};">
                        <span style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7;">Oda Sayƒ±sƒ±</span>
                        <span style="font-size: ${baseSize * 1.1}px; font-weight: 600; color: ${primaryColor};">${loc.roomCount}</span>
                    </div>
                </div>
            `).join('');
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px; overflow-y: auto;">
                    <div style="max-width: 1000px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">Konaklama Noktasƒ± Se√ßin</h1>
                            ${currentUser ? `<button onclick="currentView='dashboard'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">Dashboard</button>` : `<button onclick="currentView='login'; renderCurrentView();" style="padding: 8px 16px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">Giri≈ü Yap</button>`}
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 16px;">
                            ${locationsHTML}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderDateSelect() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px; display: flex; align-items: center; justify-content: center;">
                    <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 500px; width: 100%;">
                        <div style="background: ${bgColor}; padding: 16px; border-radius: 8px; margin-bottom: 24px;">
                            <h2 style="font-size: ${baseSize * 1.3}px; font-weight: 600; margin-bottom: 8px;">üìç ${selectedLocation.name}</h2>
                            <p style="font-size: ${baseSize * 0.9}px; color: ${textColor}; opacity: 0.7;">${selectedLocation.city} - ${selectedLocation.highway}</p>
                        </div>
                        
                        <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700; margin-bottom: 8px;">Tarih ve Saat Se√ßin</h1>
                        <p style="font-size: ${baseSize * 0.9}px; color: ${textColor}; opacity: 0.7; margin-bottom: 32px;">Konaklama s√ºrenizi belirleyin</p>
                        
                        <form onsubmit="searchAvailableRooms(event)">
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Giri≈ü Tarihi ve Saati</label>
                                <input type="datetime-local" id="check-in" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">√áƒ±kƒ±≈ü Tarihi ve Saati</label>
                                <input type="datetime-local" id="check-out" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px; margin-bottom: 12px;">
                                M√ºsait Odalarƒ± G√∂ster
                            </button>
                            
                            <button type="button" onclick="currentView='location-select'; renderCurrentView();" style="width: 100%; padding: 12px; background: ${surfaceColor}; color: ${secondaryColor}; border: 1px solid ${secondaryColor}; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                Geri D√∂n
                            </button>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderAvailableRooms() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            const checkInDate = new Date(selectedDateRange.checkIn);
            const checkOutDate = new Date(selectedDateRange.checkOut);
            const hours = ((checkOutDate - checkInDate) / (1000 * 60 * 60)).toFixed(1);
            const estimatedPrice = (hours * 100).toFixed(2);
            
            const roomsHTML = availableRooms.map(room => `
                <div onclick="selectRoom('${room.id}')" style="background: ${surfaceColor}; padding: 20px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); border: 2px solid transparent; transition: all 0.3s ease; cursor: pointer;" 
                     onmouseover="this.style.borderColor='${primaryColor}'; this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.1)';" 
                     onmouseout="this.style.borderColor='transparent'; this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 4px rgba(0,0,0,0.05)';">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div>
                            <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; margin-bottom: 4px;">Oda ${room.number}</h3>
                            <p style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7;">Se√ßilen tarihte m√ºsait</p>
                        </div>
                        <div style="font-size: ${baseSize * 2}px;">‚úÖ</div>
                    </div>
                </div>
            `).join('');
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px; overflow-y: auto;">
                    <div style="max-width: 800px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">M√ºsait Odalar</h1>
                            <button onclick="currentView='date-select'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                Tarihleri Deƒüi≈ütir
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <h2 style="font-size: ${baseSize * 1.2}px; font-weight: 600; margin-bottom: 12px;">üìç ${selectedLocation.name}</h2>
                            <p style="font-size: ${baseSize * 0.9}px; color: ${textColor}; opacity: 0.7; margin-bottom: 8px;">
                                <strong>Giri≈ü:</strong> ${checkInDate.toLocaleString('tr-TR')}
                            </p>
                            <p style="font-size: ${baseSize * 0.9}px; color: ${textColor}; opacity: 0.7; margin-bottom: 8px;">
                                <strong>√áƒ±kƒ±≈ü:</strong> ${checkOutDate.toLocaleString('tr-TR')}
                            </p>
                            <p style="font-size: ${baseSize * 0.9}px; color: ${textColor}; opacity: 0.7; margin-bottom: 8px;">
                                <strong>S√ºre:</strong> ${hours} saat
                            </p>
                            <p style="font-size: ${baseSize * 1.1}px; font-weight: 600; color: ${primaryColor}; margin-top: 12px;">
                                <strong>Tahmini √úcret:</strong> ${estimatedPrice} ‚Ç∫
                            </p>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <h2 style="font-size: ${baseSize * 1.2}px; font-weight: 600; margin-bottom: 16px;">${availableRooms.length} Bo≈ü Oda Bulundu</h2>
                            <div style="display: grid; gap: 12px;">
                                ${roomsHTML}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderReservationDetails() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px; display: flex; align-items: center; justify-content: center;">
                    <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 500px; width: 100%;">
                        <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700; margin-bottom: 24px;">Rezervasyon Detaylarƒ±</h1>
                        
                        <div style="background: ${bgColor}; padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Konum:</strong> ${selectedLocation.name}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Oda:</strong> ${window.selectedRoom.number}</p>
                        </div>
                        
                        <form onsubmit="submitReservation(event)">
                            <div style="margin-bottom: 24px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Ka√ß ki≈üi kalacaksƒ±nƒ±z?</label>
                                <input type="number" id="guest-count" min="1" max="10" value="2" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px; margin-bottom: 12px;">
                                √ñdemeye Ge√ß
                            </button>
                            
                            <button type="button" onclick="currentView='available-rooms'; renderCurrentView();" style="width: 100%; padding: 12px; background: ${surfaceColor}; color: ${secondaryColor}; border: 1px solid ${secondaryColor}; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                Geri D√∂n
                            </button>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderPayment() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px; display: flex; align-items: center; justify-content: center;">
                    <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 500px; width: 100%;">
                        <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700; margin-bottom: 24px;">√ñdeme</h1>
                        
                        <div style="background: ${bgColor}; padding: 20px; border-radius: 8px; margin-bottom: 24px;">
                            <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; margin-bottom: 12px;">Rezervasyon √ñzeti</h3>
                            <div style="font-size: ${baseSize * 0.9}px; color: ${textColor}; opacity: 0.8;">
                                <p style="margin-bottom: 8px;">Konum: ${window.pendingReservation.location.name}</p>
                                <p style="margin-bottom: 8px;">Oda: ${window.pendingReservation.room.number}</p>
                                <p style="margin-bottom: 8px;">Ki≈üi Sayƒ±sƒ±: ${window.pendingReservation.guest_count}</p>
                                <p style="margin-bottom: 8px;">S√ºre: ${window.pendingReservation.hours} saat</p>
                                <p style="font-size: ${baseSize * 1.3}px; font-weight: 700; margin-top: 16px; color: ${primaryColor};">
                                    Toplam: ${window.pendingReservation.price} ‚Ç∫
                                </p>
                            </div>
                        </div>
                        
                        <form onsubmit="processPayment(event)">
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Kart Numarasƒ±</label>
                                <input type="text" id="card-number" maxlength="16" placeholder="1234 5678 9012 3456" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 24px;">
                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Son Kullanma</label>
                                    <input type="text" id="expiry" placeholder="MM/YY" maxlength="5" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">CVV</label>
                                    <input type="text" id="cvv" maxlength="3" placeholder="123" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                </div>
                            </div>
                            
                            <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px; margin-bottom: 12px;">
                                √ñdemeyi Tamamla
                            </button>
                            
                            <button type="button" onclick="currentView='reservation-details'; renderCurrentView();" style="width: 100%; padding: 12px; background: ${surfaceColor}; color: ${secondaryColor}; border: 1px solid ${secondaryColor}; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                Geri D√∂n
                            </button>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderTicket() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            
            const ticket = window.currentTicket;
            const checkIn = new Date(ticket.check_in).toLocaleString('tr-TR');
            const checkOut = new Date(ticket.check_out).toLocaleString('tr-TR');
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px; display: flex; align-items: center; justify-content: center;">
                    <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 500px; width: 100%; text-align: center;">
                        <div style="font-size: ${baseSize * 2.5}px; margin-bottom: 12px;">üéâ</div>
                        <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700; margin-bottom: 12px; color: ${primaryColor};">Rezervasyon Ba≈üarƒ±lƒ±!</h1>
                        
                        <div class="qr-code" style="margin: 24px auto;">
                            <svg width="180" height="180" viewBox="0 0 180 180">
                                <rect width="180" height="180" fill="white"/>
                                <rect x="20" y="20" width="20" height="20" fill="black"/>
                                <rect x="60" y="20" width="20" height="20" fill="black"/>
                                <rect x="100" y="20" width="20" height="20" fill="black"/>
                                <rect x="140" y="20" width="20" height="20" fill="black"/>
                                <rect x="20" y="60" width="20" height="20" fill="black"/>
                                <rect x="140" y="60" width="20" height="20" fill="black"/>
                                <rect x="20" y="100" width="20" height="20" fill="black"/>
                                <rect x="60" y="100" width="20" height="20" fill="black"/>
                                <rect x="100" y="100" width="20" height="20" fill="black"/>
                                <rect x="140" y="100" width="20" height="20" fill="black"/>
                                <rect x="20" y="140" width="20" height="20" fill="black"/>
                                <rect x="60" y="140" width="20" height="20" fill="black"/>
                                <rect x="100" y="140" width="20" height="20" fill="black"/>
                                <rect x="140" y="140" width="20" height="20" fill="black"/>
                            </svg>
                        </div>
                        
                        <div style="background: ${bgColor}; padding: 20px; border-radius: 8px; margin-top: 24px; text-align: left;">
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 12px;"><strong>Bilet Numarasƒ±:</strong> ${ticket.ticket_number}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 12px;"><strong>Konum:</strong> ${ticket.location_name}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 12px;"><strong>Oda:</strong> ${ticket.room_number}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 12px;"><strong>Ki≈üi Sayƒ±sƒ±:</strong> ${ticket.guest_count}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 12px;"><strong>Giri≈ü:</strong> ${checkIn}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 12px;"><strong>√áƒ±kƒ±≈ü:</strong> ${checkOut}</p>
                            <p style="font-size: ${baseSize * 1.1}px; margin-top: 16px; color: ${primaryColor}; font-weight: 700;"><strong>√úcret:</strong> ${ticket.price} ‚Ç∫</p>
                        </div>
                        
                        <p style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7; margin-top: 20px;">
                            QR kodu kapƒ± okuyucusuna g√∂stererek odaya girebilirsiniz
                        </p>
                        
                        <button onclick="currentView='room-control'; window.currentRoomId = '${ticket.room_id}'; renderCurrentView();" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px; margin-top: 24px;">
                            Oda Kontrol Paneli
                        </button>
                    </div>
                </div>
            `;
        }

        function renderRoomControl() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 600px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">Oda Kontrol</h1>
                            <button onclick="currentView='dashboard'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                Dashboard
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; margin-bottom: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                <div>
                                    <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; margin-bottom: 4px;">üí° I≈üƒ±k Kontrol√º</h3>
                                    <p style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7;">Oda aydƒ±nlatmasƒ±nƒ± kontrol edin</p>
                                </div>
                                <label style="position: relative; display: inline-block; width: 60px; height: 34px;">
                                    <input type="checkbox" id="light-control" style="opacity: 0; width: 0; height: 0;">
                                    <span onclick="toggleLight()" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #ccc; border-radius: 34px; transition: 0.4s;"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; margin-bottom: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                <div>
                                    <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; margin-bottom: 4px;">‚ùÑÔ∏è Klima Kontrol√º</h3>
                                    <p style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7;">Oda sƒ±caklƒ±ƒüƒ±nƒ± ayarlayƒ±n</p>
                                </div>
                                <label style="position: relative; display: inline-block; width: 60px; height: 34px;">
                                    <input type="checkbox" id="ac-control" style="opacity: 0; width: 0; height: 0;">
                                    <span onclick="toggleAC()" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #ccc; border-radius: 34px; transition: 0.4s;"></span>
                                </label>
                            </div>
                            <div id="ac-temp" style="display: none;">
                                <input type="range" min="16" max="30" value="22" id="temp-slider" oninput="updateTemp(this.value)" style="width: 100%; margin-top: 12px;">
                                <p style="text-align: center; margin-top: 8px; font-size: ${baseSize * 1.1}px; font-weight: 600;" id="temp-display">22¬∞C</p>
                            </div>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <h3 style="font-size: ${baseSize * 1.2}px; font-weight: 600; margin-bottom: 12px;">üö™ Kapƒ± Kontrol√º</h3>
                            <p style="font-size: ${baseSize * 0.85}px; color: ${textColor}; opacity: 0.7; margin-bottom: 16px;">QR kodunuzu okutarak kapƒ±yƒ± a√ßabilirsiniz</p>
                            <button onclick="openDoor()" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                Kapƒ±yƒ± A√ß
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function toggleLight() {
            const checkbox = document.getElementById('light-control');
            const span = checkbox.nextElementSibling;
            checkbox.checked = !checkbox.checked;
            span.style.background = checkbox.checked ? '#3b82f6' : '#ccc';
            showToast(checkbox.checked ? 'I≈üƒ±k a√ßƒ±ldƒ±' : 'I≈üƒ±k kapatƒ±ldƒ±', 'success');
        }

        function toggleAC() {
            const checkbox = document.getElementById('ac-control');
            const span = checkbox.nextElementSibling;
            const tempDiv = document.getElementById('ac-temp');
            checkbox.checked = !checkbox.checked;
            span.style.background = checkbox.checked ? '#3b82f6' : '#ccc';
            tempDiv.style.display = checkbox.checked ? 'block' : 'none';
            showToast(checkbox.checked ? 'Klima a√ßƒ±ldƒ±' : 'Klima kapatƒ±ldƒ±', 'success');
        }

        function updateTemp(value) {
            document.getElementById('temp-display').textContent = value + '¬∞C';
        }

        function openDoor() {
            showToast('Kapƒ± a√ßƒ±lƒ±yor...', 'success');
            setTimeout(() => {
                showToast('Kapƒ± a√ßƒ±ldƒ±! L√ºtfen i√ßeri giriniz', 'success');
            }, 1500);
        }

        function renderDashboard() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            return `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 1000px; margin: 0 auto;">
                        <div style="background: ${surfaceColor}; padding: 20px; border-radius: 12px; margin-bottom: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <h1 style="font-size: ${baseSize * 1.3}px; font-weight: 700; margin-bottom: 12px;">Ho≈ü Geldiniz, ${currentUser.ad} ${currentUser.soyad}</h1>
                            <p style="font-size: ${baseSize * 0.9}px; color: ${textColor}; opacity: 0.7; margin-bottom: 16px;">Kullanƒ±cƒ± adƒ±: ${currentUser.username}</p>
                            <button onclick="logout()" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                √áƒ±kƒ±≈ü Yap
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <h2 style="font-size: ${baseSize * 1.3}px; font-weight: 600; margin-bottom: 16px;">Men√º</h2>
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <button onclick="currentView='past-reservations'; renderCurrentView();" style="padding: 12px; background: ${surfaceColor}; border: 1px solid ${primaryColor}; color: ${primaryColor}; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: ${baseSize * 0.9}px; text-align: left;">
                                    √ñnceki Rezervasyonlarƒ±m
                                </button>
                                <button onclick="currentView='current-reservation'; renderCurrentView();" style="padding: 12px; background: ${surfaceColor}; border: 1px solid ${primaryColor}; color: ${primaryColor}; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: ${baseSize * 0.9}px; text-align: left;">
                                    ≈ûu Anda Bulunan Rezervasyonum
                                </button>
                                <button onclick="currentView='cancel-reservation'; renderCurrentView();" style="padding: 12px; background: ${surfaceColor}; border: 1px solid ${primaryColor}; color: ${primaryColor}; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: ${baseSize * 0.9}px; text-align: left;">
                                    Rezervasyon ƒ∞ptali
                                </button>
                                <button onclick="currentView='change-credentials'; renderCurrentView();" style="padding: 12px; background: ${surfaceColor}; border: 1px solid ${primaryColor}; color: ${primaryColor}; border-radius: 6px; cursor: pointer; font-weight: 500; font-size: ${baseSize * 0.9}px; text-align: left;">
                                    ≈ûifremi / Kullanƒ±cƒ± Adƒ±mƒ± Deƒüi≈ütir
                                </button>
                                <button onclick="currentView='location-select'; renderCurrentView();" style="padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: ${baseSize}px;">
                                    Rezervasyon Yap
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderPastReservations() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            const { past } = getUserReservations();
            const app = document.getElementById('app');
            
            let content = '';
            
            if (past.length === 0) {
                content = `
                    <div style="text-align: center; padding: 40px;">
                        <p style="font-size: ${baseSize * 1.1}px; color: ${textColor}; opacity: 0.7;">Herhangi bir ge√ßmi≈ü rezervasyonunuz bulunmamaktadƒ±r.</p>
                    </div>
                `;
            } else {
                content = past.map(res => `
                    <div style="background: ${bgColor}; padding: 20px; border-radius: 8px; margin-bottom: 16px;">
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Konum:</strong> ${res.location_name}</p>
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Oda:</strong> ${res.room_number}</p>
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Giri≈ü:</strong> ${new Date(res.check_in).toLocaleString('tr-TR')}</p>
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>√áƒ±kƒ±≈ü:</strong> ${new Date(res.check_out).toLocaleString('tr-TR')}</p>
                        <p style="font-size: ${baseSize * 0.9}px;"><strong>√úcret:</strong> ${res.price} ‚Ç∫</p>
                    </div>
                `).join('');
            }
            
            app.innerHTML = `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 800px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">√ñnceki Rezervasyonlarƒ±m</h1>
                            <button onclick="currentView='dashboard'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                Geri D√∂n
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            ${content}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCurrentReservation() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            const { active } = getUserReservations();
            const app = document.getElementById('app');
            
            let content = '';
            
            if (!active) {
                content = `
                    <div style="text-align: center; padding: 40px;">
                        <p style="font-size: ${baseSize * 1.1}px; color: ${textColor}; opacity: 0.7;">Aktif rezervasyonunuz bulunmamaktadƒ±r.</p>
                    </div>
                `;
            } else {
                const now = new Date();
                const checkIn = new Date(active.check_in);
                const isCheckedIn = now >= checkIn;
                
                content = `
                    <div style="background: ${bgColor}; padding: 20px; border-radius: 8px; margin-bottom: 16px;">
                        ${isCheckedIn ? `<div style="background: ${primaryColor}; color: white; padding: 12px; border-radius: 6px; margin-bottom: 16px; text-align: center; font-weight: 600;">Odaya giri≈ü yaptƒ±ƒüƒ±nƒ±z tespit edildi. ≈ûu anda konaklamaktasƒ±nƒ±z.</div>` : ''}
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Konum:</strong> ${active.location_name}</p>
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Oda:</strong> ${active.room_number}</p>
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Giri≈ü:</strong> ${checkIn.toLocaleString('tr-TR')}</p>
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>√áƒ±kƒ±≈ü:</strong> ${new Date(active.check_out).toLocaleString('tr-TR')}</p>
                        <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 16px;"><strong>√úcret:</strong> ${active.price} ‚Ç∫</p>
                        ${isCheckedIn ? `<button onclick="currentView='room-control'; window.currentRoomId='${active.room_id}'; renderCurrentView();" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">Oda Kontrol Paneli</button>` : ''}
                    </div>
                `;
            }
            
            app.innerHTML = `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 800px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">Aktif Rezervasyonum</h1>
                            <button onclick="currentView='dashboard'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                Geri D√∂n
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            ${content}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderCancelReservation() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            const { active, cancelled } = getUserReservations();
            const app = document.getElementById('app');
            
            let cancelledContent = '';
            if (cancelled.length > 0) {
                cancelledContent = `
                    <div style="margin-bottom: 32px;">
                        <h2 style="font-size: ${baseSize * 1.3}px; font-weight: 600; margin-bottom: 16px;">ƒ∞ptal Edilen Rezervasyonlar</h2>
                        ${cancelled.map(res => `
                            <div style="background: ${bgColor}; padding: 16px; border-radius: 8px; margin-bottom: 12px;">
                                <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Konum:</strong> ${res.location_name}</p>
                                <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Oda:</strong> ${res.room_number}</p>
                                <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>ƒ∞ptal Tarihi:</strong> ${new Date(res.cancelled_at).toLocaleString('tr-TR')}</p>
                                <p style="font-size: ${baseSize * 0.9}px;"><strong>ƒ∞ptal Nedeni:</strong> ${res.cancellation_reason || 'Belirtilmedi'}</p>
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            let activeContent = '';
            if (active) {
                activeContent = `
                    <div>
                        <h2 style="font-size: ${baseSize * 1.3}px; font-weight: 600; margin-bottom: 16px;">Rezervasyonunuzu ƒ∞ptal Et</h2>
                        <div style="background: ${bgColor}; padding: 20px; border-radius: 8px; margin-bottom: 16px;">
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Konum:</strong> ${active.location_name}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Oda:</strong> ${active.room_number}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 8px;"><strong>Giri≈ü:</strong> ${new Date(active.check_in).toLocaleString('tr-TR')}</p>
                            <p style="font-size: ${baseSize * 0.9}px; margin-bottom: 16px;"><strong>√áƒ±kƒ±≈ü:</strong> ${new Date(active.check_out).toLocaleString('tr-TR')}</p>
                        </div>
                        
                        <form onsubmit="event.preventDefault(); const reason = document.getElementById('cancel-reason').value; cancelReservation('${active.id}', reason);">
                            <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">ƒ∞ptal Nedeni</label>
                            <textarea id="cancel-reason" rows="4" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px; margin-bottom: 16px; resize: vertical;" placeholder="ƒ∞ptal nedeninizi belirtiniz (isteƒüe baƒülƒ±)"></textarea>
                            <button type="submit" style="width: 100%; padding: 12px; background: #ef4444; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                Rezervasyonu ƒ∞ptal Et
                            </button>
                        </form>
                    </div>
                `;
            } else {
                activeContent = `
                    <div style="text-align: center; padding: 40px;">
                        <p style="font-size: ${baseSize * 1.1}px; color: ${textColor}; opacity: 0.7;">ƒ∞ptal edilebilecek aktif rezervasyonunuz bulunmamaktadƒ±r.</p>
                    </div>
                `;
            }
            
            app.innerHTML = `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 800px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">Rezervasyon ƒ∞ptali</h1>
                            <button onclick="currentView='dashboard'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                Geri D√∂n
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            ${cancelledContent}
                            ${activeContent}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderChangeCredentials() {
            const customFont = window.elementSdk?.config?.font_family || defaultConfig.font_family;
            const baseSize = window.elementSdk?.config?.font_size || defaultConfig.font_size;
            const bgColor = window.elementSdk?.config?.background_color || defaultConfig.background_color;
            const surfaceColor = window.elementSdk?.config?.surface_color || defaultConfig.surface_color;
            const textColor = window.elementSdk?.config?.text_color || defaultConfig.text_color;
            const primaryColor = window.elementSdk?.config?.primary_action_color || defaultConfig.primary_action_color;
            const secondaryColor = window.elementSdk?.config?.secondary_action_color || defaultConfig.secondary_action_color;
            
            const app = document.getElementById('app');
            
            app.innerHTML = `
                <div style="background: ${bgColor}; font-family: ${customFont}, system-ui, sans-serif; font-size: ${baseSize}px; color: ${textColor}; min-height: 100%; padding: 16px;">
                    <div style="max-width: 600px; margin: 0 auto;">
                        <div style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 20px;">
                            <h1 style="font-size: ${baseSize * 1.5}px; font-weight: 700;">Bilgilerimi Deƒüi≈ütir</h1>
                            <button onclick="currentView='dashboard'; renderCurrentView();" style="padding: 8px 16px; background: ${secondaryColor}; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: ${baseSize * 0.85}px;">
                                Geri D√∂n
                            </button>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; margin-bottom: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <h2 style="font-size: ${baseSize * 1.3}px; font-weight: 600; margin-bottom: 16px;">≈ûifre Deƒüi≈ütir</h2>
                            <form onsubmit="event.preventDefault(); changePassword();">
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Mevcut ≈ûifre</label>
                                    <input type="password" id="current-password" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                </div>
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Yeni ≈ûifre (En az 1 harf ve 1 noktalama i≈üareti)</label>
                                    <input type="password" id="new-password" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                </div>
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Yeni ≈ûifre Tekrar</label>
                                    <input type="password" id="new-password-confirm" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                </div>
                                <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                    ≈ûifreyi Deƒüi≈ütir
                                </button>
                            </form>
                        </div>
                        
                        <div style="background: ${surfaceColor}; padding: 24px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <h2 style="font-size: ${baseSize * 1.3}px; font-weight: 600; margin-bottom: 16px;">Kullanƒ±cƒ± Adƒ± Deƒüi≈ütir</h2>
                            <form onsubmit="event.preventDefault(); changeUsername();">
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Mevcut Kullanƒ±cƒ± Adƒ±</label>
                                    <input type="text" value="${currentUser.username}" disabled style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px; background: ${bgColor};">
                                </div>
                                <div style="margin-bottom: 16px;">
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: ${baseSize * 0.9}px;">Yeni Kullanƒ±cƒ± Adƒ±</label>
                                    <input type="text" id="new-username" style="width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 6px; font-size: ${baseSize}px;" required>
                                </div>
                                <button type="submit" style="width: 100%; padding: 12px; background: ${primaryColor}; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: ${baseSize}px;">
                                    Kullanƒ±cƒ± Adƒ±nƒ± Deƒüi≈ütir
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            `;
        }

        function changePassword() {
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const newPasswordConfirm = document.getElementById('new-password-confirm').value;
            
            if (currentPassword !== currentUser.password) {
                showToast('Mevcut ≈üifre hatalƒ±', 'error');
                return;
            }
            
            if (!validatePassword(newPassword)) {
                showToast('Yeni ≈üifre en az 1 harf ve 1 noktalama i≈üareti i√ßermelidir', 'error');
                return;
            }
            
            if (newPassword !== newPasswordConfirm) {
                showToast('Yeni ≈üifreler e≈üle≈ümiyor', 'error');
                return;
            }
            
            currentUser.password = newPassword;
            updateUser(currentUser);
            showToast('≈ûifre ba≈üarƒ±yla deƒüi≈ütirildi', 'success');
            currentView = 'dashboard';
            renderCurrentView();
        }

        function changeUsername() {
            const newUsername = document.getElementById('new-username').value;
            
            const users = getUsers();
            const existingUser = users.find(u => u.username === newUsername && u.id !== currentUser.id);
            
            if (existingUser) {
                showToast('Bu kullanƒ±cƒ± adƒ± zaten kullanƒ±lƒ±yor', 'error');
                return;
            }
            
            currentUser.username = newUsername;
            updateUser(currentUser);
            showToast('Kullanƒ±cƒ± adƒ± ba≈üarƒ±yla deƒüi≈ütirildi', 'success');
            currentView = 'dashboard';
            renderCurrentView();
        }

        function renderCurrentView() {
            const app = document.getElementById('app');
            
            switch(currentView) {
                case 'login':
                    app.innerHTML = renderLogin();
                    break;
                case 'register':
                    app.innerHTML = renderRegister();
                    break;
                case 'dashboard':
                    app.innerHTML = renderDashboard();
                    break;
                case 'location-select':
                    app.innerHTML = renderLocationSelect();
                    break;
                case 'date-select':
                    app.innerHTML = renderDateSelect();
                    break;
                case 'available-rooms':
                    app.innerHTML = renderAvailableRooms();
                    break;
                case 'reservation-details':
                    app.innerHTML = renderReservationDetails();
                    break;
                case 'payment':
                    app.innerHTML = renderPayment();
                    break;
                case 'ticket':
                    app.innerHTML = renderTicket();
                    break;
                case 'room-control':
                    app.innerHTML = renderRoomControl();
                    break;
                case 'past-reservations':
                    renderPastReservations();
                    break;
                case 'current-reservation':
                    renderCurrentReservation();
                    break;
                case 'cancel-reservation':
                    renderCancelReservation();
                    break;
                case 'change-credentials':
                    renderChangeCredentials();
                    break;
                default:
                    app.innerHTML = renderLogin();
            }
        }

        async function onConfigChange(config) {
            const customFont = config.font_family || defaultConfig.font_family;
            const baseSize = config.font_size || defaultConfig.font_size;
            const bgColor = config.background_color || defaultConfig.background_color;
            const surfaceColor = config.surface_color || defaultConfig.surface_color;
            const textColor = config.text_color || defaultConfig.text_color;
            
            document.body.style.fontFamily = `${customFont}, system-ui, sans-serif`;
            document.body.style.fontSize = `${baseSize}px`;
            document.body.style.color = textColor;
            
            renderCurrentView();
        }

        function init() {
            if (window.elementSdk) {
                window.elementSdk.init({
                    defaultConfig,
                    onConfigChange,
                    mapToCapabilities: (config) => ({
                        recolorables: [
                            {
                                get: () => config.background_color || defaultConfig.background_color,
                                set: (value) => {
                                    config.background_color = value;
                                    window.elementSdk.setConfig({ background_color: value });
                                }
                            },
                            {
                                get: () => config.surface_color || defaultConfig.surface_color,
                                set: (value) => {
                                    config.surface_color = value;
                                    window.elementSdk.setConfig({ surface_color: value });
                                }
                            },
                            {
                                get: () => config.text_color || defaultConfig.text_color,
                                set: (value) => {
                                    config.text_color = value;
                                    window.elementSdk.setConfig({ text_color: value });
                                }
                            },
                            {
                                get: () => config.primary_action_color || defaultConfig.primary_action_color,
                                set: (value) => {
                                    config.primary_action_color = value;
                                    window.elementSdk.setConfig({ primary_action_color: value });
                                }
                            },
                            {
                                get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
                                set: (value) => {
                                    config.secondary_action_color = value;
                                    window.elementSdk.setConfig({ secondary_action_color: value });
                                }
                            }
                        ],
                        borderables: [],
                        fontEditable: {
                            get: () => config.font_family || defaultConfig.font_family,
                            set: (value) => {
                                config.font_family = value;
                                window.elementSdk.setConfig({ font_family: value });
                            }
                        },
                        fontSizeable: {
                            get: () => config.font_size || defaultConfig.font_size,
                            set: (value) => {
                                config.font_size = value;
                                window.elementSdk.setConfig({ font_size: value });
                            }
                        }
                    }),
                    mapToEditPanelValues: (config) => new Map([
                        ['app_title', config.app_title || defaultConfig.app_title],
                        ['welcome_message', config.welcome_message || defaultConfig.welcome_message],
                        ['support_phone', config.support_phone || defaultConfig.support_phone],
                        ['support_email', config.support_email || defaultConfig.support_email]
                    ])
                });
            }
            
            renderCurrentView();
        }

        init();
    </script>

  <script>
window.addEventListener("DOMContentLoaded", () => {
    renderCurrentView();
});
</script>
  
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ab68687c5b426ad',t:'MTc2NTMwNDUyMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
